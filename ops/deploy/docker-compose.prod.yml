services:
  aionbd:
    image: ${AIONBD_IMAGE:-ghcr.io/aionbd/aionbd-server:${AIONBD_IMAGE_TAG:-latest}}
    container_name: aionbd
    restart: unless-stopped
    ports:
      - "${AIONBD_HOST_PORT:-8080}:8080"
    env_file:
      - .env.prod
    volumes:
      - aionbd_data:/var/lib/aionbd
      - ./certs:/etc/aionbd/certs:ro
    read_only: true
    tmpfs:
      - /tmp:rw,noexec,nosuid,size=64m
    security_opt:
      - no-new-privileges:true
    ulimits:
      nofile:
        soft: 65535
        hard: 65535
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "5"

volumes:
  aionbd_data:
